<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Aper√ßu ‚Äì Offre du jour</title>

  <!-- üîê Protection par e-mail (universelle) -->
  <script>
    (function () {
      const params = new URLSearchParams(window.location.search);
      const email = params.get('email');
      const localEmail = localStorage.getItem('user_email');

      if (email) {
        localStorage.setItem('user_email', email);
        // Nettoyer l'URL sans recharger la page
        const cleanUrl = window.location.pathname.split('?')[0];
        window.history.replaceState({}, document.title, cleanUrl);
      }

      if (!email && !localEmail) {
        const pathParts = window.location.pathname.split('/');
        const basePath = '/' + pathParts[1] + '/';
        window.location.href = basePath + 'inscription.html';
      }
    })();
  </script>

  <style>
    :root{
      --brand:#B48C4A;
      --topbar-h:56px;
    }

    html, body {
      margin: 0;
      padding: 0;
      width: 100%;
      height: 100%;
      background: transparent;
      font-family: 'Montserrat', sans-serif;
    }

    /* üîù Barre top + bouton retour */
    .topbar{
      position: fixed;
      top: 0; left: 0; right: 0;
      height: var(--topbar-h);
      display:flex;
      align-items:center;
      justify-content:flex-start;
      padding: 0 14px;
      z-index: 99999;
      pointer-events: none; /* pour laisser l‚Äôiframe scroller */
    }

    .back-btn{
      pointer-events: auto; /* r√©active le clic sur le bouton */
      display: inline-grid;
      place-items: center;
      width: 40px;
      height: 40px;
      border-radius: 50%;
      background: rgba(180,140,74,.16);
      border: none;
      cursor: pointer;
      transition: transform .15s ease, background .15s ease;
    }

    .back-btn:hover{
      transform: scale(1.05);
      background: rgba(180,140,74,.26);
    }

    .back-btn::before{
      content:"";
      display:block;
      width: 12px;
      height: 12px;
      border-left: 3px solid var(--brand);
      border-bottom: 3px solid var(--brand);
      transform: translateX(2px) rotate(45deg);
    }

    iframe {
      width: 100%;
      height: 100vh;
      border: none;
      display: block;
    }
  </style>
</head>

<body>

  <!-- üîô Bouton retour -->
  <header class="topbar">
    <button class="back-btn" type="button" aria-label="Retour" onclick="goBackUniversal()"></button>
  </header>

  <iframe
    src="https://admin.fidelavis.com/resto1-offre-du-jour"
    title="Offre du jour ‚Äì Fidelavis"
    loading="lazy">
  </iframe>

  <script>
    function goBackUniversal(){
      // 1) retour historique si possible
      if (window.history.length > 1) {
        window.history.back();
        return;
      }
      // 2) fallback universel : page d‚Äôaccueil du m√™me dossier
      // (modifie ici si tu veux un autre fallback)
      window.location.href = "./index.html";
    }
  </script>

</body>
</html>
